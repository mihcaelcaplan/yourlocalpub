"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{5833:function(e,r,t){t.r(r),t.d(r,{default:function(){return d}});var o=t(7437),n=t(2265),s=t(6176),i=t(7158);function l(e){let{publication_key:r,isHidden:t,setHidden:n}=e;return(0,o.jsx)("div",{className:t+" flex flex-col fixed top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 h-1/3 lg:h-1/2 w-4/6 xl:w-1/2 bg-slate-100 z-10 shadow-2xl border-black border-2",children:(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"absolute top-0 bg-stone-200 z-10 w-full ml-auto border-b-black border-b-2",children:(0,o.jsx)("div",{className:"text-[1rem] leading-[1.rem] bg-red-500 hover:bg-red-800 w-6 h-6 text-center ml-auto border-l-black border-l-2",onClick:()=>{n("hidden")},children:"X"})}),(0,o.jsx)("div",{className:"absolute w-full h-full",children:(0,o.jsx)(a,{})}),(0,o.jsx)("div",{className:"absolute top-1/3 -translate-y-1/2 left-1/2 -translate-x-1/2 w-5/6 md:w-3/4",children:(0,o.jsxs)("div",{className:"text-center m-auto p-1 md:p-4 lg:p-6 text-sm lg:text-2xl lg:leading-8 bg-white border-2 border-black w-auto",children:["You're a right good pub-goer.",(0,o.jsx)("br",{}),"Well on ya, mate!",(0,o.jsx)("br",{})]})})]})})}let a=()=>{let e="h-1/6";return(0,o.jsxs)("div",{className:"h-full",children:[(0,o.jsxs)("div",{className:"grid grid-rows-1 grid-cols-brick1 ".concat(e),children:[(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!1}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0})]}),(0,o.jsxs)("div",{className:"grid grid-rows-1 grid-cols-brick2 ".concat(e),children:[(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!1}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0})]}),(0,o.jsxs)("div",{className:"grid grid-rows-1 grid-cols-brick3 ".concat(e),children:[(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!1}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0})]}),(0,o.jsxs)("div",{className:"grid grid-rows-1 grid-cols-brickGoToCart ".concat(e),children:[(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!0,borderL:!1}),(0,o.jsx)("a",{href:"/",className:"flex bg-green-600 text-white justify-center border-t-2 border-t-black",children:(0,o.jsx)("div",{className:"text-[0.75rem] lg:text-2xl md:text-[1.5vw] leading-4 self-center font-semibold text-center",children:"Keep Shopping"})}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!0,borderL:!0}),(0,o.jsx)("a",{href:"/cart",className:"flex bg-yellow-400 text-white justify-center border-t-2 border-t-black",children:(0,o.jsx)("div",{className:"text-[0.75rem] lg:text-2xl md:text-[1.5vw] leading-4 self-center font-semibold text-center",children:"Go to Cart"})}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0})]}),(0,o.jsxs)("div",{className:"grid grid-rows-1 grid-cols-brick5 ".concat(e),children:[(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!1}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0})]}),(0,o.jsxs)("div",{className:"grid grid-rows-1 grid-cols-brick2 ".concat(e),children:[(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!1}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0}),(0,o.jsx)(i.Q,{borderT:!0,borderB:!1,borderR:!1,borderL:!0})]})]})};function d(e){let{publication_key:r}=e,[t,i]=(0,n.useContext)(s.A),[a,d]=(0,n.useState)("hidden");return(0,o.jsxs)("div",{children:[(0,o.jsx)(l,{isHidden:a,setHidden:d,publication_key:r}),(0,o.jsx)("div",{href:"/cart",className:"h-6 w-auto p-4 bg-pubbrickblue font-semibold text-white hover:bg-indigo-400 border-black border-2 text-center align-middle leading-[0rem] whitespace-nowrap ",onClick:()=>{!function(){let e={...t};e[r]?e[r].quantity+=1:e[r]={quantity:1},console.log(e),i(r=>({...e}))}(),d("visible")},children:"BUY"})]})}},7158:function(e,r,t){t.d(r,{L:function(){return s},Q:function(){return n}});var o=t(7437);let n=e=>{let{position:r,borderT:t,borderB:n,borderR:s,borderL:i,span:l}=e,a=l>1?"col-span-".concat(l):"";return(0,o.jsx)("div",{className:"bg-pubbrick ".concat(t?"border-t border-t-2 border-t-black ":""," ").concat(n?"border-b border-b-2 border-b-black":""," ").concat(s?"border-r border-r-2 border-r-black":""," ").concat(i?"border-l border-l-2 border-l-black":""," ").concat(a)})},s=()=>(0,o.jsx)("div",{className:""})},6176:function(e,r,t){t.d(r,{A:function(){return n}});var o=t(2265);let n=(0,o.createContext)([])},3543:function(e,r,t){t.r(r),t.d(r,{default:function(){return u}});var o=t(7437),n=t(6691),s=t.n(n),i=t(2265);let l={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},a={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},d="mousemove",c="mouseup";function b(e,r){if(0===r)return e;let t=Math.PI/180*r,o=e[0]*Math.cos(t)+e[1]*Math.sin(t),n=e[1]*Math.cos(t)-e[0]*Math.sin(t);return[o,n]}function u(e){let{publication:r,image_paths:t}=e,[n,u]=(0,i.useState)(!1),[h,g]=(0,i.useState)(t[0]),x=e=>{if("Left"==e){let e=(t.map(e=>e.large).indexOf(h.large)+1)%t.length;g(t[e])}else if("Right"==e){let e=((t.map(e=>e.large).indexOf(h.large)-1)%t.length+t.length)%t.length;g(t[e])}},m=e=>{let r;switch(e.key){case"Escape":u(!1);break;case"ArrowRight":r=(t.map(e=>e.large).indexOf(h.large)+1)%t.length,g(t[r]);break;case"ArrowLeft":r=((t.map(e=>e.large).indexOf(h.large)-1)%t.length+t.length)%t.length,g(t[r])}};(0,i.useEffect)(()=>(document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}),[h]);let f=function(e){var r,t,o;let n;let{trackMouse:s}=e,u=i.useRef(Object.assign({},a)),h=i.useRef(Object.assign({},l)),g=i.useRef(Object.assign({},h.current));for(n in g.current=Object.assign({},h.current),h.current=Object.assign(Object.assign({},l),e),l)void 0===h.current[n]&&(h.current[n]=l[n]);let[x,m]=i.useMemo(()=>(function(e,r){let t=r=>{let t="touches"in r;t&&r.touches.length>1||e((e,n)=>{n.trackMouse&&!t&&(document.addEventListener(d,o),document.addEventListener(c,i));let{clientX:s,clientY:l}=t?r.touches[0]:r,u=b([s,l],n.rotationAngle);return n.onTouchStartOrOnMouseDown&&n.onTouchStartOrOnMouseDown({event:r}),Object.assign(Object.assign(Object.assign({},e),a),{initial:u.slice(),xy:u,start:r.timeStamp||0})})},o=r=>{e((e,t)=>{let o="touches"in r;if(o&&r.touches.length>1)return e;if(r.timeStamp-e.start>t.swipeDuration)return e.swiping?Object.assign(Object.assign({},e),{swiping:!1}):e;let{clientX:n,clientY:s}=o?r.touches[0]:r,[i,a]=b([n,s],t.rotationAngle),d=i-e.xy[0],c=a-e.xy[1],u=Math.abs(d),h=Math.abs(c),g=(r.timeStamp||0)-e.start,x=Math.sqrt(u*u+h*h)/(g||1),m=[d/(g||1),c/(g||1)],f=u>h?d>0?"Right":"Left":c>0?"Down":"Up",p="number"==typeof t.delta?t.delta:t.delta[f.toLowerCase()]||l.delta;if(u<p&&h<p&&!e.swiping)return e;let j={absX:u,absY:h,deltaX:d,deltaY:c,dir:f,event:r,first:e.first,initial:e.initial,velocity:x,vxvy:m};j.first&&t.onSwipeStart&&t.onSwipeStart(j),t.onSwiping&&t.onSwiping(j);let v=!1;return(t.onSwiping||t.onSwiped||t[`onSwiped${f}`])&&(v=!0),v&&t.preventScrollOnSwipe&&t.trackTouch&&r.cancelable&&r.preventDefault(),Object.assign(Object.assign({},e),{first:!1,eventData:j,swiping:!0})})},n=r=>{e((e,t)=>{let o;if(e.swiping&&e.eventData){if(r.timeStamp-e.start<t.swipeDuration){o=Object.assign(Object.assign({},e.eventData),{event:r}),t.onSwiped&&t.onSwiped(o);let n=t[`onSwiped${o.dir}`];n&&n(o)}}else t.onTap&&t.onTap({event:r});return t.onTouchEndOrOnMouseUp&&t.onTouchEndOrOnMouseUp({event:r}),Object.assign(Object.assign(Object.assign({},e),a),{eventData:o})})},s=()=>{document.removeEventListener(d,o),document.removeEventListener(c,i)},i=e=>{s(),n(e)},u=(e,r)=>{let s=()=>{};if(e&&e.addEventListener){let i=Object.assign(Object.assign({},l.touchEventOptions),r.touchEventOptions),a=[["touchstart",t,i],["touchmove",o,Object.assign(Object.assign({},i),r.preventScrollOnSwipe?{passive:!1}:{})],["touchend",n,i]];a.forEach(([r,t,o])=>e.addEventListener(r,t,o)),s=()=>a.forEach(([r,t])=>e.removeEventListener(r,t))}return s},h={ref:r=>{null!==r&&e((e,t)=>{if(e.el===r)return e;let o={};return e.el&&e.el!==r&&e.cleanUpTouch&&(e.cleanUpTouch(),o.cleanUpTouch=void 0),t.trackTouch&&r&&(o.cleanUpTouch=u(r,t)),Object.assign(Object.assign(Object.assign({},e),{el:r}),o)})}};return r.trackMouse&&(h.onMouseDown=t),[h,u]})(e=>u.current=e(u.current,h.current),{trackMouse:s}),[s]);return u.current=(r=u.current,t=h.current,o=g.current,t.trackTouch&&r.el?r.cleanUpTouch?t.preventScrollOnSwipe!==o.preventScrollOnSwipe||t.touchEventOptions.passive!==o.touchEventOptions.passive?(r.cleanUpTouch(),Object.assign(Object.assign({},r),{cleanUpTouch:m(r.el,t)})):r:Object.assign(Object.assign({},r),{cleanUpTouch:m(r.el,t)}):(r.cleanUpTouch&&r.cleanUpTouch(),Object.assign(Object.assign({},r),{cleanUpTouch:void 0}))),x}({onSwiped:e=>x(e.dir),swipeDuration:500,preventScrollOnSwipe:!0,trackMouse:!0}),p=e=>{if("bg"==e.target.id)u(!1);else if("forward"==e.target.id){let e=(t.map(e=>e.large).indexOf(h.large)+1)%t.length;g(t[e])}else if("back"==e.target.id){let e=((t.map(e=>e.large).indexOf(h.large)-1)%t.length+t.length)%t.length;g(t[e])}};return(0,o.jsxs)("div",{className:"pb-6 sm:pl-4 sm:pr-4 max-w-[750px] m-auto flex flex-col items-center ",children:[(0,o.jsx)("div",{id:"bg",className:n?"absolute z-20 top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 w-full bg-black mb-2 justify-center":"flex flex-col w-[100%] bg-white relative mb-2 justify-center",children:(0,o.jsx)(s(),{...f,onClick:()=>u(!0),className:n?"z-30":"",priority:!0,src:h.large,alt:"Photo of book: filename ".concat(h.large),placeholder:"blur",blurDataURL:h.small,quality:75,height:75,width:100,sizes:"100vw",style:{width:"100%",height:"75%"}})}),(0,o.jsx)("div",{className:"flex flex-row overflow-scroll md:h-[5rem] h-[3rem] w-full justify-start overflow-hidden",children:t.map(e=>(0,o.jsx)(s(),{className:"pr-2 ".concat(e.large===h?"opacity-100":"opacity-50"),onClick:()=>g(e),src:e.large,placeholder:"blur",blurDataURL:e.small,alt:"$(publication.title) cover image",width:100,height:75,quality:1,sizes:"75vw",loading:"lazy",style:{height:"100%",width:"100%"}},e.large))}),n&&(0,o.jsx)("div",{id:"bg",className:"bg-black fixed top-0 left-0 h-screen w-screen z-10",onClick:e=>p(e)}),n&&(0,o.jsx)("div",{className:"fixed top-6 right-6 w-4 h-4 xl:w-5 xl:h-5 text-[0.7rem] leading-[1.1rem] xl:text-[1rem] xl:leading-[1.3rem] rounded-full bg-gray-100 opacity-70 hover:bg-red-700  text-center z-50",onClick:()=>{u(!1)},children:"X"}),n&&(0,o.jsx)("div",{id:"back",className:"fixed z-40 top-0 left-0 h-full w-1/4",onClick:e=>p(e)}),n&&(0,o.jsx)("div",{id:"forward",className:"fixed z-40 top-0 right-0 h-full w-1/4git ",onClick:e=>p(e)})]})}},7115:function(e,r,t){t.r(r),t.d(r,{getInventory:function(){return o}});let o=async e=>{let r=await fetch("https://p3p22yr8sg.execute-api.eu-west-2.amazonaws.com/default/checkInventory?"+new URLSearchParams({productId:e}));if(r.ok){let t=await r.json();return console.log("inventory for ".concat(e,":"),t),t}}},8724:function(e,r,t){t.r(r),t.d(r,{default:function(){return l}});var o=t(7437),n=t(5833),s=t(2265),i=t(7115);function l(e){let{publication:r,publication_key:t}=e,[l,a]=(0,s.useState)({soldOut:!1,lockedInventory:0});return(0,s.useEffect)(()=>{console.log("updating inv."),(0,i.getInventory)(t).then(e=>{let t=!(e.lockedInventory<r.stockQuantity),o=e.lockedInventory;a({soldOut:t,lockedInventory:o})})},[]),(0,o.jsxs)("div",{className:"grid grid-cols-1 mr-2 ml-2 sm:ml-4 sm:mr-4 font-medium leading-5",children:[(0,o.jsx)("b",{children:r.title}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{className:"",children:"Published in "+r.publicationYear}),(0,o.jsx)("li",{className:"",children:r.detail})]}),(0,o.jsx)("div",{className:"mt-2 mb-4 w-inherit ",children:r.info}),(0,o.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,o.jsxs)("div",{className:"flex flex-col md:",children:[!l.soldOut&&(0,o.jsx)("div",{children:"(".concat(l.lockedInventory+1,"/").concat(r.stockQuantity,")")}),l.soldOut&&(0,o.jsx)("a",{className:" underline hover:text-pubblue",href:"mailto:support@yourlocalpublication.com?subject=Print more copies of ".concat(r.title,"&body=I want to buy one \uD83D\uDE00"),children:"Print more!"}),(0,o.jsx)("div",{className:"font-semibold",children:"\xa3"+r.price})]}),l.soldOut&&(0,o.jsx)("div",{className:"h-6 w-auto p-4 bg-pubbrickblue font-semibold text-white border-black border-2 text-center align-middle leading-[0rem] text-[0.75rem]  sm:text-[1rem]  md:text-[1.25rem] whitespace-nowrap",children:" Sold out!"}),!l.soldOut&&(0,o.jsx)(n.default,{publication_key:t})]})]})}}}]);